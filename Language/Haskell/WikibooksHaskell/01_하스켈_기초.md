# Haskell - 하스켈 기초

참고자료 : [WikibooksHaskell](https://wikidocs.net/book/204)

## 2 변수와 함수

### 변수(variable)

연산의 중간 결과를 변수에 저장할 수 있다. 변수는 그 이름으로 참조할 수 있으며 값을 포함한다.

### 주석 

하스켈에서 주석은 `--`로 시작하고 줄이 끝나기 전까지 이어진다.

```haskell
x = 5 -- x is 5
y = 6 -- y is 6
-- z = 7
```

주석의 다른 문법인 `{- ... -}`을 쓰면 어디에든 주석을 넣을 수 있다.

```haskell
x = {- 그냥 가능한 짓이라 해봤다. -} 5
```

### 명령형 언어의 변수

명령형 언어와 달리 하스켈의 변수는 **변하지 않는다**.
변수는 변경 불가능하다. 
예를 들어 다음 코드는 작동하지 않는다.

```haskell
r = 5
r = 2
```

위 코드를 실행하면 다음과 같은 오류가 발생한다.

```
multiple declarations of r. 
```

함수형 프로그래밍 언어에서는 컴퓨터의 메모리로 무엇을 할지 그 방안을 마련하는 책임이 프로그램에 있다.

```haskell
r = r + 1
```

위 코드는 **변수 r**의 값을 증가시키는 것이 아니라 r을 이용하여 r을 정의하는 재귀적 정의이다.

수학적 문맥으로 표시하면  `5 = 5 + 1`라고 말하는 것이나 마찬가지 이다.

다음 코드들은 정확히 같은 일을 한다.

```haskell
y = x * 2
x = 3
```

``` haskell
x = 3
y = x * 2
```

변수들을 원하는 순서대로 작성할 수 있는 것은 **y에 앞서 x를 선언** 한다는 개념이 없기 때문이다.

y의 값을 출력하기 직전까지는 x의 값이 실제로 필요하지 않다. (게으른 연산)

### 함수

반지름이 서로 다른 여러 개의 원들의 넓이를 계산하려고 한다. 서로 다른 원들의 반지름을 표현하기 위해 **r1**, **r2**라는 2개의 변수를 사용한다.

```haskell
r1 = 5
area1 = pi * r ^ 2

r2 = 3
area2 = pi * r2 ^ 2
```

여기서 반지름으로 넓이를 구하는 공식이 반복되고 있다. 함수를 이용하여 이 반복을 해결할 수 있다.

함수는 인자값(또는 매개변수)을 취해 결과값을 돌려준다. - 본질적으로 수학의 함수와 동일하다.
하스켈에서 함수를 정의하는 방법은 다음과 같다.

```haskell
area r = pi * r ^ 2
```

인자 **r** 을 가지고 넓이를 계산하는 함수 **area**를 정의하는 코드이다.

함수 이름이 맨 처음에 온다. 그 다음 공백이 오고 그 다음은 인자가 온다. **=** 기호 다음의 함수 정의는 한 공식으로서 그 인자를 이미 정의된 다른 용어들과 함께 사용한다.

이렇게 함수를 정의하면 다음과 같이 인자에 서로 다른 값을 넣을 수 있다.

```haskell
area 5
area 3
area 17
```

### 평가 (evaluation)

함수를 적용 (apply) 하거나 호출 (call) 한다는 것은 함수 정의의 좌변을 우변으로 치환한다는 것을 뜻한다.

아래 함수를 사용하여 연습문제를 해결해 보자

```haskell
double x = 2 * x
quadruple x = double (double x)
square x = x * x
half x = x / 2
```

> 문제 1
> GHCi가 quadruple 5 를 어떻게 평가하는지 설명하라.
> ```haskell
> quadruple 5 => double (double 5)
>             => 2 * (double 5)
>             => 2 * (2 * 5)
>             => 2 * 10
>             => 20
> ```

> 문제2
> 인자의 절반에서 12를 빼는 함수를 작성하라.
> ```haskell
> foo x = (half x) - 12
> ```
> 또는
> ```haskell
> minusdozen x = x - 12
> foo x = minusdozen (half x)
> ```

### 여러 개의 매개변수

함수는 인자를 하나보다 많이 가질 수 있다. 

```haskell
areaRect l w = l * w
```

인수들은 공백으로 구분된다. 이것이 가끔 표현식을 묶기 위해 괄호를 써야하는 이유다.
예를 들어 x를 네제곱하기 위해서 다음과 같이 함수를 써야 한다.

```haskell
quadruple x = double (double x)
```

위 코드는 double라는 함수를 두 인자 double과 x에 적용한다는 뜻. 함수도 다른 함수의 인자가 될 수 있다.

인자는 항상 주어진 순서대로 전달 된다.

> 연습문제 1
> 상자의 부패를 계산하는 함수를 작성하라.
> ```haskell
> volume x y z = x * y * z
> ```
>
> 연습문제 2 
> 기자에 있는 유명한 피라미드를 이루는 돌은 대략 몇 개일까? 힌트 : 피라미드의 부피와 각각의 블록의 부피를 추정해야 한다.
> ```
>  피라미드를 이루는 블럭의 개수 = 피라미드의 부피 / 블록의 부피 ? 
> $$$Count_b = \frac{V_p}{V_b}$$$
> ```

### 함수 합성에 대한 의견

덧셈 또는 곱셈같은 미리 정의된 함수들을 이용할 수 있는 것처럼 이미 정의한 함수를 가지고 새로운 함수를 정의할 수 있다.

하스켈에서는 연산자가 함수로 정의된다.

```haskell
areaRect l w = l * w
areaSquare s = areaRect s s
```

> 연습문제1
> 원통의 부피를 계산하는 함수를 작성하라.
> 원통의 부피는 원 모양의 바닥의 넓이 (이 장에서 이미 작성함 함수를 재활용) 곱하기 높이이다.
> ```haskell
> cylinder_volume r h = h * (area r)
> ```

### 지역 정의 (local definition) - where 절

함수를 정의할 때 그 함수에 한정된 중간 결과를 정의하는 경우

```haskell
areaTriangleTrig a b c = c * height / 2
    where
    cosa = (b ^ 2 + c ^ 2 - a ^ 2) / (2 * b * c)
    sina = sqrt (1 - cosa ^ 2)
    height = b * sina
    
areaTriangleHeron a b c = result
    where
    result = sqrt (s * (s - a) * (s - b) * (s - c))
    s = (a + b + c) / 2
```

where를 사용하여 각 지역 정의들을 우변의 일부로 만들었다.
where와 지역 정의를 둘 다 공백 4개로 들여써서, 이어지는 정의들과 구별했다는 것에 주목.

### 지역 정의 (local definition) - 스코프 (scope)

```haskell
> let r = 0
> let area r = pi * r ^ 2
> area 5
78.5398
```

let을 사용하여 r 변수를 area 함수의 인자와는 별도의 스코프에 정의하였다.

### 요약

1. 변수는 값을 저장한다. 사실 변수는 임의의 하스켈 표현식을 저장한다.
2. 변수는 변하지 않는다.
3. 함수는 재사용 가능한 코드 작성을 돕는다.
4. 함수는 하나보다 더 많은 인자를 취할 수 있다.
5. 주석은 소스파일 안에서 코드가 아닌 텍스트이다.


## 3 진위값

### 동등 비교와 기타 비교들

값들이 같은 지 비교하는 경우에는 이중 등호인 `==`를 사용한다.
이외에도 `<`(미만), `>`(초과), `<=`(이하), `>=`(이상)등 많은 검사를 제공한다.

```haskell
> 2 + 3 == 5
True

> 7 + 3 == 5
False

> let f x = x + 3
> f 2 == 5
True

> let area r = pi * r ^ 2
> area 5 < 50
False
```

### 불리언 값

수학 표현식을 입력하면 그 표현식은 평가되고 결과 숫자값이 화면에 표시된다.
수학 표현식이 비교 검사인 경우 반환되는 값은 `True` 혹은 `False` 이다.
이런 값을 **진위값** 또는 **불리언 값**이라고 부른다.

### 타입의 도입

`True`와 `False`는 하스켈에서 *Bool*타입이다.
일반적으로 값은 타입을 가지고 있다.
타입은 그 값을 가지고 무엇을 할 수 있고, 무엇을 할 수 없는지를 정의한다.
값의 행동을 말이 되는 규칙으로써 제한할 수단을 제공하여, 제대로 동작한느 프로그램을 작성하는 것을 쉽게 만든다.

서로 다른 타입간에 연산할 수 없는 연산자의 경우 질문자체가 성립되지 않으므로 에러를 반환한다.

```haskell
> 2 == True
> No instance for (Num Bool) arising from the literal '2'...
```

### 중위 연산자

` 2 == True` 에서 `2`는 `==`의 첫번째 인자이다.
`==`는 중위 연산자이자 함수로써 자신의 좌변과 우변을 인자로 취한다.

중위 연산자를 일반적인 함수의 형태 (전위 연산자)로 표현하려면 연산자를 괄호로 감싸야 한다.
아래의 두 식은 동치이다.

```haskell
> 4 + 9 == 13
True
W
> (==) (4 + 9) 13
True
```

### 불리언 연산

불리언 연산은 진위값 (Bool 타입)을 논리 명제로써 조작하는 연산이다.

- `(&&)` 은 and 연산(논리곱)을 수행한다.
- `(||)` 은 or 연산(논리합)을 수행한다.
- `not`은 불리언 값의 반전을 수행한다.
- 비항등이라는 또다른 관계 연산자가 있다. 하스켈에서는 `(/=)` 함수로 제공하지만 아래와 같이 직접 구현할 수 있다.
> ```haskell
> x /= y = not (x == y)
> ```

연산자를 정의할 때도 위와 같이 중위로 쓰는 것은 완벽히 올바른 문법이다.
ASCII 기호들을 사용해서 새로운 연산자를 만들 수도 있다.

### 가드 (guard)

절댓값 함수의 경우, 입력된 수가 음수인가 양수인가에 따라 결과가 달라진다.
보통 프로그래밍 언어의 경우 if 문을 사용하여 절댓값 함수를 구현한다.

그러나 하스켈에서는 수학식과 유사한 가드를 사용하여 아래와 같이 표현할 수 있다.

```haskell
abs x
    | x < 0 = 0 - x
    | otherwise = x
```

위 코드에서 함수 정의 좌변 뒤에 `=`와 우변을 적는 대신 

- 줄 바꿈을 하고 두 대체문을 별개의 줄에 놓았다. 이 대체문들을 가드라고 한다.
- 각각의 가드는 파이프 문자 `|`로 시작한다. 파이프 뒤에는 불리언 값으로 평가되는 표현식을 놓는다.
- 그 다음에 `=`를 포함한 정의의 나머지 부분이 온다.
- `otherwise`는 다른 프로그래밍 언어의 `switch` 구문의 `default`와 같은 역할을 한다. 실제로 `otherwise`는 `True`와 동치이다. 따라서 `otherwise`는 항상 마지막에 쓰도록 한다.

### where와 가드

2차 방정식 $$$ax^2 + bx + c = 0$$$의 실수 해의 개수를 구하는 함수를 다음과 같이 구현할 수 있다

```haskell
numOfSolutions a b c 
    | disc > 0 = 2
    | disc == 0 = 1
    | otherwise = 0
        where
        disc = b ^ 2 - 4 * a * c
```

`where` 정의는 모든 가드 스코프 내에 있어서 disc의 표현식을 대체한다.

